Alice's potion making professor gave the following assignment to his students: brew a potion using nn ingredients, such that the proportion of ingredient ii in the final potion is ri>0ri>0 (and r1+r2+⋯+rn=1r1+r2+⋯+rn=1).
He forgot the recipe, and now all he remembers is a set of n−1n−1 facts of the form, "ingredients ii and jj should have a ratio of xx to yy" (i.e., if aiai and ajaj are the amounts of ingredient ii and jj in the potion respectively, then it must hold ai/aj=x/yai/aj=x/y), where xx and yy are positive integers. However, it is guaranteed that the set of facts he remembers is sufficient to uniquely determine the original values riri.
He decided that he will allow the students to pass the class as long as they submit a potion which satisfies all of the n−1n−1 requirements (there may be many such satisfactory potions), and contains a positive integer amount of each ingredient.
Find the minimum total amount of ingredients needed to make a potion which passes the class. As the result can be very large, you should print the answer modulo 998244353998244353.
