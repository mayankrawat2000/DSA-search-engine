Mr. Chanek has an orchard structured as a rooted ternary tree with NN vertices numbered from 11 to NN. The root of the tree is vertex 11. PiPi denotes the parent of vertex ii, for (2≤i≤N)(2≤i≤N). Interestingly, the height of the tree is not greater than 1010. Height of a tree is defined to be the largest distance from the root to a vertex in the tree.
There exist a bush on each vertex of the tree. Initially, all bushes have fruits. Fruits will not grow on bushes that currently already have fruits. The bush at vertex ii will grow fruits after AiAi days since its last harvest.
Mr. Chanek will visit his orchard for QQ days. In day ii, he will harvest all bushes that have fruits on the subtree of vertex XiXi. For each day, determine the sum of distances from every harvested bush to XiXi, and the number of harvested bush that day. Harvesting a bush means collecting all fruits on the bush.
For example, if Mr. Chanek harvests all fruits on subtree of vertex XX, and harvested bushes [Y1,Y2,…,YM][Y1,Y2,…,YM], the sum of distances is ∑Mi=1distance(X,Yi)∑i=1Mdistance(X,Yi)
distance(U,V)distance(U,V) in a tree is defined to be the number of edges on the simple path from UU to VV.
