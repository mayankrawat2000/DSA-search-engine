There is a city park represented as a tree with nn attractions as its vertices and n−1n−1 rails as its edges. The ii-th attraction has happiness value aiai.
Each rail has a color. It is either black if ti=0ti=0, or white if ti=1ti=1. Black trains only operate on a black rail track, and white trains only operate on a white rail track. If you are previously on a black train and want to ride a white train, or you are previously on a white train and want to ride a black train, you need to use 11 ticket.
The path of a tour must be a simple path — it must not visit an attraction more than once. You do not need a ticket the first time you board a train. You only have kk tickets, meaning you can only switch train types at most kk times. In particular, you do not need a ticket to go through a path consisting of one rail color.
Define f(u,v)f(u,v) as the sum of happiness values of the attractions in the tour (u,v)(u,v), which is a simple path that starts at the uu-th attraction and ends at the vv-th attraction. Find the sum of f(u,v)f(u,v) for all valid tours (u,v)(u,v) (1≤u≤v≤n1≤u≤v≤n) that does not need more than kk tickets, modulo 109+7109+7.
