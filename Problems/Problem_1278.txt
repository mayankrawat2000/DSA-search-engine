We start with a permutation a1,a2,…,ana1,a2,…,an and with an empty array bb. We apply the following operation kk times.
On the ii-th iteration, we select an index titi (1≤ti≤n−i+11≤ti≤n−i+1), remove atiati from the array, and append one of the numbers ati−1ati−1 or ati+1ati+1 (if ti−1ti−1 or ti+1ti+1 are within the array bounds) to the right end of the array bb. Then we move elements ati+1,…,anati+1,…,an to the left in order to fill in the empty space.
You are given the initial permutation a1,a2,…,ana1,a2,…,an and the resulting array b1,b2,…,bkb1,b2,…,bk. All elements of an array bb are distinct. Calculate the number of possible sequences of indices t1,t2,…,tkt1,t2,…,tk modulo 998244353998244353.
