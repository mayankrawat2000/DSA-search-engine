Have you ever used the chat application QQ? Well, in a chat group of QQ, administrators can muzzle a user for days.
In Boboniu's chat group, there's a person called Du Yi who likes to make fun of Boboniu every day.
Du will chat in the group for nn days. On the ii-th day:
  If Du can speak, he'll make fun of Boboniu with fun factor aiai. But after that, he may be muzzled depending on Boboniu's mood.  Otherwise, Du won't do anything. 
Boboniu's mood is a constant mm. On the ii-th day:
  If Du can speak and ai>mai>m, then Boboniu will be angry and muzzle him for dd days, which means that Du won't be able to speak on the i+1,i+2,⋯,min(i+d,n)i+1,i+2,⋯,min(i+d,n)-th days.  Otherwise, Boboniu won't do anything. 
The total fun factor is the sum of the fun factors on the days when Du can speak.
Du asked you to find the maximum total fun factor among all possible permutations of aa.
