Yura is a mathematician, and his cognition of the world is so absolute as if he have been solving formal problems a hundred of trillions of billions of years. This problem is just that!
Consider all non-negative integers from the interval [0,10n)[0,10n). For convenience we complement all numbers with leading zeros in such way that each number from the given interval consists of exactly nn decimal digits.
You are given a set of pairs (ui,vi)(ui,vi), where uiui and vivi are distinct decimal digits from 00 to 99.
Consider a number xx consisting of nn digits. We will enumerate all digits from left to right and denote them as d1,d2,…,dnd1,d2,…,dn. In one operation you can swap digits didi and di+1di+1 if and only if there is a pair (uj,vj)(uj,vj) in the set such that at least one of the following conditions is satisfied:
  di=ujdi=uj and di+1=vjdi+1=vj,  di=vjdi=vj and di+1=ujdi+1=uj. 
We will call the numbers xx and yy, consisting of nn digits, equivalent if the number xx can be transformed into the number yy using some number of operations described above. In particular, every number is considered equivalent to itself.
You are given an integer nn and a set of mm pairs of digits (ui,vi)(ui,vi). You have to find the maximum integer kk such that there exists a set of integers x1,x2,…,xkx1,x2,…,xk (0≤xi<10n0≤xi<10n) such that for each 1≤i<j≤k1≤i<j≤k the number xixi is not equivalent to the number xjxj.
