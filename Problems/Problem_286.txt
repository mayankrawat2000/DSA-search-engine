This is the hard version of the problem. The difference is the constraints on nn, mm and tt. You can make hacks only if all versions of the problem are solved.
Alice and Bob are given the numbers nn, mm and kk, and play a game as follows:
The game has a score that Alice tries to maximize, and Bob tries to minimize. The score is initially 00. The game consists of nn turns. Each turn, Alice picks a real number from 00 to kk (inclusive) which Bob either adds to or subtracts from the score of the game. But throughout the game, Bob has to choose to add at least mm out of the nn turns.
Bob gets to know which number Alice picked before deciding whether to add or subtract the number from the score, and Alice gets to know whether Bob added or subtracted the number for the previous turn before picking the number for the current turn (except on the first turn since there was no previous turn).
If Alice and Bob play optimally, what will the final score of the game be?
