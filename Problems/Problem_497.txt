This problem is a complicated version of D1, but it has significant differences, so read the whole statement.
Polycarp has an array of nn (nn is even) integers a1,a2,…,ana1,a2,…,an. Polycarp conceived of a positive integer kk. After that, Polycarp began performing the following operations on the array: take an index ii (1≤i≤n1≤i≤n) and reduce the number aiai by kk.
After Polycarp performed some (possibly zero) number of such operations, it turned out that at least half of the numbers in the array became the same. Find the maximum kk at which such a situation is possible, or print −1−1 if such a number can be arbitrarily large.
