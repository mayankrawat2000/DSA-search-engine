Let's consider a (109+1)×(109+1)(109+1)×(109+1) field. The rows are numbered with integers from 00 to 109109 and the columns are numbered with integers from 00 to 109109. Let's define as (x,y)(x,y) the cell located in the xx-th row and yy-th column.
Let's call a cell (x,y)(x,y) good if x&y=0x&y=0, there && is the bitwise and operation.
Let's build a graph where vertices will be all good cells of the field and we will make an edge between all pairs of adjacent by side good cells. It can be proved that this graph will be a tree — connected graph without cycles. Let's hang this tree on vertex (0,0)(0,0), so we will have a rooted tree with root (0,0)(0,0).
Two players will play the game. Initially, some good cells are black and others are white. Each player on his turn chooses a black good cell and a subset of its ancestors (possibly empty) and inverts their colors (from white to black and vice versa). The player who can't move (because all good cells are white) loses. It can be proved that the game is always finite.
Initially, all cells are white. You are given mm pairs of cells. For each pair color all cells in a simple path between them as black. Note that we do not invert their colors, we paint them black.
Sohrab and Mashtali are going to play this game. Sohrab is the first player and Mashtali is the second.
Mashtali wants to win and decided to cheat. He can make the following operation multiple times before the game starts: choose a cell and invert colors of all vertices on the path between it and the root of the tree.
Mammad who was watching them wondered: "what is the minimum number of operations Mashtali should do to have a winning strategy?".
Find the answer to this question for the initial painting of the tree. It can be proved that at least one possible way to cheat always exists.
