Alice and Bob are playing a game (yet again).
They have two sequences of segments of the coordinate axis: a sequence of nn initial segments: [l1,r1][l1,r1], [l2,r2][l2,r2], ..., [ln,rn][ln,rn], and a sequence of mm terminal segments: [L1,R1][L1,R1], [L2,R2][L2,R2], ..., [Lm,Rm][Lm,Rm]. At the beginning of the game, they choose one of the initial segments and set it as the current segment.
Alice and Bob make alternating moves: Alice makes the first move, Bob makes the second move, Alice makes the third one, and so on. During each move, the current player must shrink the current segment either by increasing its left endpoint by 11, or by decreasing its right endpoint by 11. So, if the current segment is [cl,cr][cl,cr], it becomes either [cl+1,cr][cl+1,cr], or [cl,cr−1][cl,cr−1].
If at the beginning of the game or after Bob's move the current segment coincides with one of the terminal segments, Bob wins. If the current segment becomes degenerate (cl=crcl=cr), and Bob hasn't won yet, Alice wins. If the current segment coincides with one of the terminal segments after Alice's move, nothing happens — the game continues.
Both players play optimally — if they can win, they always use a strategy that leads them to victory in the minimum number of turns, and if they cannot win, they try to prolong the game, using the strategy allowing them to make the maximum possible number of moves until their defeat.
For each of the initial segments you have to determine who will win the game if this segment is chosen as the current segment at the beginning of the game. If Bob wins, you also have to calculate the number of moves Alice will make before her defeat.
