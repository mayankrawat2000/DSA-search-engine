Prefix function of string t=t1t2…tnt=t1t2…tn and position ii in it is defined as the length kk of the longest proper (not equal to the whole substring) prefix of substring t1t2…tit1t2…ti which is also a suffix of the same substring.
For example, for string t=t= abacaba the values of the prefix function in positions 1,2,…,71,2,…,7 are equal to [0,0,1,0,1,2,3][0,0,1,0,1,2,3].
Let f(t)f(t) be equal to the maximum value of the prefix function of string tt over all its positions. For example, f(f(abacaba)=3)=3.
You are given a string ss. Reorder its characters arbitrarily to get a string tt (the number of occurrences of any character in strings ss and tt must be equal). The value of f(t)f(t) must be minimized. Out of all options to minimize f(t)f(t), choose the one where string tt is the lexicographically smallest.
