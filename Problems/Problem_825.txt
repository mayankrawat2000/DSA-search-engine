Getting ready for VK Fest 2021, you prepared a table with nn rows and nn columns, and filled each cell of this table with some event related with the festival that could either happen or not: for example, whether you will win a prize on the festival, or whether it will rain.
Forecasting algorithms used in VK have already estimated the probability for each event to happen. Event in row ii and column jj will happen with probability ai,j⋅10−4ai,j⋅10−4. All of the events are mutually independent.
Let's call the table winning if there exists a line such that all nn events on it happen. The line could be any horizontal line (cells (i,1),(i,2),…,(i,n)(i,1),(i,2),…,(i,n) for some ii), any vertical line (cells (1,j),(2,j),…,(n,j)(1,j),(2,j),…,(n,j) for some jj), the main diagonal (cells (1,1),(2,2),…,(n,n)(1,1),(2,2),…,(n,n)), or the antidiagonal (cells (1,n),(2,n−1),…,(n,1)(1,n),(2,n−1),…,(n,1)).
Find the probability of your table to be winning, and output it modulo 3160731607 (see Output section).
